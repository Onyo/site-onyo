var allcompanies = {
	"data": [{
		"numericalId": 78,
		"name": "Baked Potato Shopping Metro Tatuapé",
		"displayName": "Shopping Metro Tatuapé"
	}, {
		"numericalId": 62,
		"name": "Baked Potato Shopping Metro Itaquera 2",
		"displayName": "Shopping Metro Itaquera 2"
	}, {
		"numericalId": 60,
		"name": "Baked Potato Shopping Interlagos",
		"displayName": "Shopping Interlagos"
	}, {
		"numericalId": 35,
		"name": "Baked Potato Pátio Paulista",
		"displayName": "Pátio Paulista"
	}, {
		"numericalId": 71,
		"name": "Baked Potato Parque Shopping Maia",
		"displayName": "Parque Shopping Maia"
	}, {
		"numericalId": 63,
		"name": "Baked Potato Jardim Sul",
		"displayName": "Jardim Sul"
	}, {
		"numericalId": 82,
		"name": "Baked Potato Shopping Metro Tucuruvi",
		"displayName": "Shopping Metro Tucuruvi"
	}, {
		"numericalId": 80,
		"name": "Baked Potato Aeroporto de Guarulhos Term. 3",
		"displayName": "Aeroporto de Guarulhos Term. 3"
	}, {
		"numericalId": 81,
		"name": "Baked Potato Tietê Plaza Shopping",
		"displayName": "Tietê Plaza Shopping"
	}, {
		"numericalId": 83,
		"name": "Baked Potato Shopping União Osasco",
		"displayName": "Shopping União Osasco"
	}, {
		"numericalId": 69,
		"name": "Baked Potato Shopping Plaza Sul",
		"displayName": "Shopping Plaza Sul"
	}, {
		"numericalId": 61,
		"name": "Baked Potato Shopping Metro Itaquera 1",
		"displayName": "Shopping Metro Itaquera 1"
	}, {
		"numericalId": 64,
		"name": "Baked Potato JundiaÃ­ Shopping",
		"displayName": "JundiaÃ­ Shopping"
	}, {
		"numericalId": 67,
		"name": "Baked Potato Boulevard Shopping Bauru",
		"displayName": "Boulevard Shopping Bauru"
	}, {
		"numericalId": 65,
		"name": "Baked Potato Shopping Metrópole",
		"displayName": "Shopping Metrópole"
	},
	// {
	// 	"numericalId": 68,
	// 	"name": "Baked Potato Parque das Bandeiras",
	// 	"displayName": "Parque das Bandeiras"
	// },
	{
		"numericalId": 70,
		"name": "Baked Potato Shopping PraÃ§a da MoÃ§a",
		"displayName": "Shopping PraÃ§a da MoÃ§a"
	}, {
		"numericalId": 72,
		"name": "Baked Potato São Bernardo Plaza Shopping",
		"displayName": "São Bernardo Plaza Shopping"
	},
	// {
	// 	"numericalId": 66,
	// 	"name": "Baked Potato Mooca Plaza Shopping",
	// 	"displayName": "Mooca Plaza Shopping"
	// },
	{
		"numericalId": 73,
		"name": "Baked Potato Park Shopping São Caetano",
		"displayName": "Park Shopping São Caetano"
	}, {
		"numericalId": 34,
		"name": "Baked Potato Shopping Marketplace",
		"displayName": "Shopping Marketplace"
	}, {
		"numericalId": 90,
		"name": "Baked Potato Top Center Shopping",
		"displayName": "Top Center Shopping"
	}, {
		"numericalId": 19,
		"name": "Baked Potato Shopping Iguatemi",
		"displayName": "Shopping Iguatemi"
	}, {
		"numericalId": 21,
		"name": "Baked Potato Shopping Cidade Jardim",
		"displayName": "Shopping Cidade Jardim"
	}, {
		"numericalId": 24,
		"name": "Baked Potato Shopping Cidade São Paulo",
		"displayName": "Shopping Cidade São Paulo"
	}, {
		"numericalId": 20,
		"name": "Baked Potato Iguatemi Alphaville",
		"displayName": "Iguatemi Alphaville"
	}, {
		"numericalId": 32,
		"name": "Baked Potato JK Iguatemi",
		"displayName": "JK Iguatemi"
	}, {
		"numericalId": 4,
		"name": "Baked Potato Morumbi Shopping Piso Superior",
		"displayName": "Morumbi Piso Superior"
	}, {
		"numericalId": 31,
		"name": "Baked Potato Vila Olímpia",
		"displayName": "Shopping Vila Olímpia"
	}, {
		"numericalId": 18,
		"name": "Baked Potato Shopping Eldorado",
		"displayName": "Shopping Eldorado"
	}, {
		"numericalId": 74,
		"name": "Baked Potato Internacional Shopping",
		"displayName": "Internacional Shopping"
	}, {
		"numericalId": 39,
		"name": "Baked Potato Shopping Aricanduva",
		"displayName": "Shopping Aricanduva"
	}, {
		"numericalId": 38,
		"name": "Baked Potato Anália Franco",
		"displayName": "Anália Franco"
	}, {
		"numericalId": 77,
		"name": "Baked Potato Shopping Tamboré",
		"displayName": "Shopping Tamboré"
	}, {
		"numericalId": 75,
		"name": "Baked Potato Santana Parque Shopping",
		"displayName": "Santana Parque Shopping"
	}, {
		"numericalId": 54,
		"name": "Baked Potato Shopping Ibirapuera",
		"displayName": "Shopping Ibirapuera"
	}, {
		"numericalId": 57,
		"name": "Baked Potato Iguatemi Ribeirão Preto",
		"displayName": "Iguatemi Ribeirão Preto"
	}, {
		"numericalId": 43,
		"name": "Baked Potato Aeroporto de Congonhas",
		"displayName": "Aeroporto de Congonhas"
	}, {
		"numericalId": 59,
		"name": "Baked Potato Iguatemi Esplanada",
		"displayName": "Iguatemi Esplanada"
	}, {
		"numericalId": 76,
		"name": "Baked Potato Shopping ABC",
		"displayName": "Shopping ABC"
	}, {
		"numericalId": 41,
		"name": "Baked Potato Shopping Center Norte",
		"displayName": "Shopping Center Norte"
	}, {
		"numericalId": 33,
		"name": "Baked Potato SP Market",
		"displayName": "SP Market"
	}, {
		"numericalId": 45,
		"name": "Baked Potato Shopping Metro Santa Cruz",
		"displayName": "Metro Santa Cruz 1"
	}, {
		"numericalId": 48,
		"name": "Baked Potato Parque Dom Pedro Shopping",
		"displayName": "Parque Dom Pedro Shopping"
	},
	// {
	// 	"numericalId": 44,
	// 	"name": "Baked Potato Continental Shopping",
	// 	"displayName": "Continental Shopping"
	// },
	{
		"numericalId": 42,
		"name": "Baked Potato Colinas Shopping",
		"displayName": "Colinas Shopping"
	}, {
		"numericalId": 40,
		"name": "Baked Potato Parque Shopping Barueri",
		"displayName": "Parque Shopping Barueri"
	},
	// {
	// 	"numericalId": 46,
	// 	"name": "Baked Potato Shopping Metro Santa Cruz 2",
	// 	"displayName": "Metro Santa Cruz 2"
	// },
	{
		"numericalId": 47,
		"name": "Baked Potato Aeroporto de Guarulhos Term. 2",
		"displayName": "Aeroporto de Guarulhos Term. 2"
	}, {
		"numericalId": 53,
		"name": "Baked Potato Pátio Higienópolis",
		"displayName": "Pátio Higienópolis"
	}, {
		"numericalId": 50,
		"name": "Baked Potato Galleria Shopping",
		"displayName": "Galleria Shopping"
	},
	// {
	// 	"numericalId": 49,
	// 	"name": "Baked Potato Hipermercado Extra Itaim",
	// 	"displayName": "Hipermercado Extra Itam"
	// },
	{
		"numericalId": 51,
		"name": "Baked Potato Golden Square",
		"displayName": "Golden Square"
	}, {
		"numericalId": 52,
		"name": "Baked Potato Shopping Granja Vianna",
		"displayName": "Shopping Granja Vianna"
	}, {
		"numericalId": 56,
		"name": "Baked Potato Iguatemi Campinas (quiosque)",
		"displayName": "Iguatemi Campinas (quiosque)"
	},
	// {
	// 	"numericalId": 58,
	// 	"name": "Baked Potato Iguatemi Rio Preto",
	// 	"displayName": "Iguatemi Rio Preto"
	// },
	{
		"numericalId": 55,
		"name": "Baked Potato Iguatemi Campinas",
		"displayName": "Iguatemi Campinas"
	}, {
		"numericalId": 84,
		"name": "Baked Potato Shopping Villa Lobos",
		"displayName": "Shopping Villa Lobos"
	}, {
		"numericalId": 85,
		"name": "Baked Potato Shopping West Plaza",
		"displayName": "Shopping West Plaza"
	}, {
		"numericalId": 79,
		"name": "Baked Potato Shopping Metro Boulevard Tatuapé",
		"displayName": "Shopping Metro Boulevard Tatuapé"
	}, {
		"numericalId": 22,
		"name": "Baked Potato Morumbi Shopping Piso Inferior",
		"menu": "http://api.onyo.com/v1/menu/3",
		"displayName": "Morumbi Piso Inferior"
	}]
}

var companies = {};

companies = {
	showCompany : function ( elem, fila, qnt ){

		$(".all-company ul").append("<li id='" + elem.numericalId + "'><strong> " + elem.numericalId + " </strong> " + elem.name + "<b class='" + elem.status + "'>" + elem.status + "</b></li>");
		if (fila===qnt) {
			var end = 0,
			total = $(".all-company ul li").length;

			$(".all-company ul li").sort(function(a, b) {
				return parseInt(a.id) - parseInt(b.id);
			}).each(function() {
				end++;
				var elem = $(this);

				elem.remove();
				$(elem).appendTo(".all-company ul");
				if (end === total) {

					$(".all-company ul").show();

					setTimeout(function(){
						companies.loadComapny();
					}, 300000);
				}
			});
		}

	},
	statusCompany : function ( elem, qnt, fila){

		$.ajax({
			cache: false,
			dataType: "json",
			type: "GET",
			url: "http://api.onyo.com/v1/mobile/company/" + elem.numericalId + "/online",
			success: function( data ) {

				if (data.online) {
					elem.status = "online";
				} else {
					elem.status = "offline";
				}

				companies.showCompany(elem, fila, qnt);
			},
			error: function( data ) {

				console.error(data);
				return true;
			}

		});
	},
	loadComapny : function (){
		$(".all-company ul").html("").hide();
		var qnt = allcompanies.data.length,
		fila = 0;

		for (var i = 0; i < allcompanies.data.length; i++) {
			var elem = allcompanies.data[i];
			fila++;

			this.statusCompany(elem, qnt, fila);
		}
	}
};

companies.init = function () {
	companies.loadComapny();
}();
